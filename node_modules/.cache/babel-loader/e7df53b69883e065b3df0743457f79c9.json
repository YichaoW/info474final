{"ast":null,"code":"var _jsxFileName = \"/Users/wyc/Desktop/info474final/src/Components/SelectionSort.js\";\nimport React from 'react';\nimport { GridStructure } from './GridStructure';\nimport { Button, ButtonGroup } from 'react-bootstrap';\nexport class SelectionSort extends GridStructure {\n  constructor(props) {\n    // 1: Grid Width 30px\n    // 2: Grid Height 30px\n    // 3: nRow: 3\n    // 4: nCol: 10\n    // 5: padding: 0.05\n    // 6: margin: top: 20px, bottom: 20px, left: 20px, right: 20px\n    super(props, 30, 30, 3, 10, 0.05, {\n      top: 20,\n      bottom: 20,\n      left: 20,\n      right: 20\n    }, \"selection\");\n    this.svg = null;\n    this.indicatorInitial = {\n      row: 3,\n      col: 10\n    };\n    this.separatorInitial = {\n      row: 1,\n      col: 1\n    };\n    this.getInitialPosition = this.getInitialPosition.bind(this);\n    this.getAction = this.getAction.bind(this);\n    this.visulizeFind = this.visulizeFind.bind(this);\n    this.visulizeMove = this.visulizeMove.bind(this);\n    this.visulizeFindInverse = this.visulizeFindInverse.bind(this);\n    this.visulizeMoveInverse = this.visulizeMoveInverse.bind(this);\n    this.initViz = this.initViz.bind(this);\n    this.clearViz = this.clearViz.bind(this);\n    let initArray = [3, 2, 6, 2, 9, 8, 4];\n    let actions = this.getAction(initArray);\n    this.state = {\n      array: initArray,\n      actions: actions,\n      step: 0,\n      speed: 200,\n      setNewArray: false,\n      animation: false\n    };\n  }\n\n  getInitialPosition(array = this.state.array) {\n    let positionMap = {};\n\n    for (let i = 0; i < array.length; i++) {\n      positionMap[i] = {\n        row: 2,\n        col: i + 2\n      };\n    }\n\n    return positionMap;\n  }\n\n  componentDidMount() {\n    this.svg = this.getSVG();\n    this.drawBasicStructure();\n    this.initViz();\n    this.setState({\n      actions: this.getAction()\n    });\n  }\n\n  clearViz() {\n    this.svg.selectAll(\"g\").remove();\n  }\n\n  initViz() {\n    let positionMap = this.getInitialPosition();\n\n    for (let i = 0; i < this.state.array.length; i++) {\n      let position = positionMap[i];\n      let num = this.state.array[i];\n      let id = \"selection-\" + i;\n      this.visulizeBox(position.row, position.col, 1, 1, num, id);\n    }\n\n    this.drawSeparator(this.separatorInitial.row, this.separatorInitial.col, \"selection\");\n    this.drawIndicator(this.indicatorInitial.row, this.indicatorInitial.col, \"min\", \"selection\");\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    let update1 = this.state.step !== nextState.step;\n    let update2 = nextState.setNewArray;\n    let update3 = nextState.animation !== this.state.animation;\n    let update4 = nextState.animation;\n    let update5 = nextState.step >= 0 && nextState.step < nextState.actions.length;\n    return (update1 || update2 || update3 || update4) && update5;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.state.setNewArray) {\n      this.clearViz();\n      this.initViz();\n      this.setState({\n        setNewArray: false\n      });\n    } else {\n      if (this.state.step > prevState.step) {\n        let action = this.state.actions[this.state.step];\n\n        if (action.desc === \"Find the Lowest #\") {\n          this.visulizeFind(action.how);\n        } else if (action.desc === \"Move the Lowest # to the End of Sorted Array\") {\n          this.visulizeMove(action.how);\n        }\n      } else if (this.state.step < prevState.step) {\n        let action = this.state.actions[prevState.step];\n\n        if (action.desc === \"Find the Lowest #\") {\n          this.visulizeFindInverse(action.how);\n        } else if (action.desc === \"Move the Lowest # to the End of Sorted Array\") {\n          this.visulizeMoveInverse(action.how);\n        }\n      }\n    }\n  }\n\n  visulizeFind(how) {\n    let moveAction = how[0].split(\" \");\n    let id = moveAction[1];\n    let to = moveAction[3].split(\"-\");\n    this.move(id, to[0], to[1], 0.15, 0.05, () => {\n      let selectAction = how[1];\n      this.select(selectAction.split(\" \")[1], null, this.state.speed);\n    }, this.state.speed);\n  }\n\n  visulizeFindInverse(how) {\n    let selectAction = how[1];\n    this.deselect(selectAction.split(\" \")[1], () => {\n      let moveAction = how[0].split(\" \");\n      let from = moveAction[2].split(\"-\");\n      let indicatorID = moveAction[1];\n      this.move(indicatorID, from[0], from[1], 0.15, 0.05, null, this.state.speed);\n    }, this.state.speed);\n  }\n\n  visulizeMove(how) {\n    let indicatorMoveAction = how[0].split(\" \");\n    let indicatorID = indicatorMoveAction[1];\n    let indicatorTo = indicatorMoveAction[3].split(\"-\");\n    this.move(indicatorID, indicatorTo[0], indicatorTo[1], 0.15, 0.05, () => {\n      let elementStage1 = how[1].split(\" \");\n      let elementID = elementStage1[1];\n      let elementMove1 = elementStage1[3].split(\"-\");\n      this.move(elementID, elementMove1[0], elementMove1[1], 0.05, 0.05, () => {\n        this.shift(how[2], () => {\n          let separatorAction = how[3].split(\" \");\n          let sepID = separatorAction[1];\n          let newSepPosition = separatorAction[3].split(\"-\");\n          this.move(sepID, newSepPosition[0], newSepPosition[1], 0.5, 1, () => {\n            let elementStage2 = how[4].split(\" \");\n            let elementMove2 = elementStage2[3].split(\"-\");\n            this.move(elementID, elementMove2[0], elementMove2[1], 0.05, 0.05, () => {\n              let elementStage3 = how[5].split(\" \");\n              let elementMove3 = elementStage3[3].split(\"-\");\n              this.move(elementID, elementMove3[0], elementMove3[1], 0.05, 0.05, () => {\n                this.sorted(elementID, this.state.speed);\n              }, this.state.speed);\n            }, this.state.speed);\n          }, this.state.speed);\n        }, this.state.speed, 1);\n      }, this.state.speed);\n    }, this.state.speed);\n  }\n\n  visulizeMoveInverse(how) {\n    let elementStage3 = how[5].split(\" \");\n    let elementID = elementStage3[1];\n    this.select(elementID, () => {\n      let elementFrom3 = elementStage3[2].split(\"-\");\n      this.move(elementID, elementFrom3[0], elementFrom3[1], 0.05, 0.05, () => {\n        let elementStage2 = how[4].split(\" \");\n        let elementFrom2 = elementStage2[2].split(\"-\");\n        this.move(elementID, elementFrom2[0], elementFrom2[1], 0.05, 0.05, () => {\n          let separatorAction = how[3].split(\" \");\n          let sepID = separatorAction[1];\n          let newSepPosition = separatorAction[2].split(\"-\");\n          this.move(sepID, newSepPosition[0], newSepPosition[1], 0.5, 1, () => {\n            this.shift(how[2], () => {\n              let elementStage1 = how[1].split(\" \");\n              let elementFrom1 = elementStage1[2].split(\"-\");\n              this.move(elementID, elementFrom1[0], elementFrom1[1], 0.05, 0.05, () => {\n                let indicatorMoveAction = how[0].split(\" \");\n                let indicatorID = indicatorMoveAction[1];\n                let indicatorFrom = indicatorMoveAction[2].split(\"-\");\n                this.move(indicatorID, indicatorFrom[0], indicatorFrom[1], 0.15, 0.05, null, this.state.speed);\n              }, this.state.speed);\n            }, this.state.speed, 0);\n          }, this.state.speed);\n        }, this.state.speed);\n      }, this.state.speed);\n    }, this.state.speed);\n  }\n\n  getAction(array = this.state.array) {\n    let actions = [{\n      desc: \"Start Sorting\",\n      how: []\n    }];\n    let arrayMap = [];\n    let positions = this.getInitialPosition(array);\n    let indexes = [];\n    let indicatorRow = this.indicatorInitial.row;\n    let sepPosition = JSON.parse(JSON.stringify(this.separatorInitial));\n\n    for (let i = 0; i < array.length; i++) {\n      indexes.push(i);\n      arrayMap.push({\n        number: array[i],\n        index: i\n      });\n    }\n\n    arrayMap = arrayMap.sort((a, b) => {\n      return a.number - b.number;\n    });\n\n    for (let i = 0; i < arrayMap.length; i++) {\n      let index = arrayMap[i].index;\n      let elementPosition = positions[index];\n      let indicatorFrom = indicatorRow + \"-\" + this.indicatorInitial.col;\n      let indicatorTo = indicatorRow + \"-\" + elementPosition.col;\n      let elementID = \"selection-\" + index;\n      let elementInitial = elementPosition.row + \"-\" + elementPosition.col;\n      let findMin = {\n        desc: \"Find the Lowest #\",\n        how: [\"Move indicator-selection \" + indicatorFrom + \" \" + indicatorTo, \"Select \" + elementID]\n      };\n      indexes[index] = null;\n      let shift = [];\n      let shiftPosition = null;\n\n      for (let i = 0; i < index; i++) {\n        if (indexes[i] !== null) {\n          let index = indexes[i];\n\n          if (shift.length === 0) {\n            shiftPosition = positions[index].row + \"-\" + positions[index].col;\n          }\n\n          positions[index].col++;\n          shift.push(\"selection-\" + index);\n        }\n      }\n\n      let sepCur = sepPosition.row + \"-\" + sepPosition.col;\n      sepPosition.col++;\n      let elementStage1 = elementPosition.row + 1 + \"-\" + elementPosition.col;\n      let elementNewCol = sepPosition.col;\n      let elementStage2 = elementPosition.row + 1 + \"-\" + elementNewCol;\n      let elementStage3 = elementPosition.row + \"-\" + elementNewCol;\n      let sepNext = sepPosition.row + \"-\" + sepPosition.col;\n      let move = {\n        desc: \"Move the Lowest # to the End of Sorted Array\",\n        how: [\"Move indicator-selection \" + indicatorTo + \" \" + indicatorFrom, \"Move \" + elementID + \" \" + elementInitial + \" \" + elementStage1, \"Shift \" + shift + \" \" + shiftPosition, \"Move separator-selection \" + sepCur + \" \" + sepNext, \"Move \" + elementID + \" \" + elementStage1 + \" \" + elementStage2, \"Move \" + elementID + \" \" + elementStage2 + \" \" + elementStage3]\n      };\n      actions.push(findMin);\n      actions.push(move);\n    }\n\n    actions.push({\n      desc: \"Sort Finished\",\n      how: []\n    });\n    return actions;\n  }\n\n  render() {\n    let actionDisplay = \"Finding Algorithm\";\n\n    if (this.state.actions.length > 0) {\n      let cur = Math.min(this.state.actions.length - 1, this.state.step);\n      actionDisplay = this.state.actions[cur].desc;\n    }\n\n    let run = \"Play\";\n\n    if (this.state.animation) {\n      run = \"Pause\";\n    }\n\n    return React.createElement(\"div\", {\n      id: \"selection\",\n      className: \"animationBox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }, actionDisplay), React.createElement(ButtonGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: () => {\n        if (this.state.step > 0) {\n          this.setState({\n            step: this.state.step - 1\n          });\n        }\n      },\n      disabled: this.state.step === 0 || this.state.animation,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, \"Prev\"), React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: () => {\n        if (this.state.step < this.state.actions.length - 1) {\n          this.setState({\n            step: this.state.step + 1\n          });\n        }\n      },\n      disabled: this.state.step === this.state.actions.length - 1 || this.state.animation,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, \"Next\"), React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: () => {\n        let newArray = this.generateRandomArray(5, 8);\n        let newAction = this.getAction(newArray);\n        this.setState({\n          array: newArray,\n          actions: newAction,\n          step: 0,\n          setNewArray: true\n        });\n      },\n      disabled: this.state.animation,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, \"Generate New Array\"), React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: () => {\n        if (!this.state.animation) {\n          let animationStep = () => {\n            this.setState({\n              animation: window.setInterval(() => {\n                if (this.state.step < this.state.actions.length - 1) {\n                  this.setState({\n                    step: this.state.step + 1\n                  });\n                } else {\n                  window.clearInterval(this.state.animation);\n                  this.setState({\n                    animation: false\n                  });\n                }\n              }, 1200)\n            });\n          };\n\n          if (this.state.step === this.state.actions.length - 1) {\n            this.setState({\n              step: 0\n            }, () => {\n              this.clearViz();\n              this.initViz();\n              animationStep();\n            });\n          } else {\n            animationStep();\n          }\n        } else {\n          window.clearInterval(this.state.animation);\n          this.setState({\n            animation: false\n          });\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346\n      },\n      __self: this\n    }, run)));\n  }\n\n}","map":{"version":3,"sources":["/Users/wyc/Desktop/info474final/src/Components/SelectionSort.js"],"names":["React","GridStructure","Button","ButtonGroup","SelectionSort","constructor","props","top","bottom","left","right","svg","indicatorInitial","row","col","separatorInitial","getInitialPosition","bind","getAction","visulizeFind","visulizeMove","visulizeFindInverse","visulizeMoveInverse","initViz","clearViz","initArray","actions","state","array","step","speed","setNewArray","animation","positionMap","i","length","componentDidMount","getSVG","drawBasicStructure","setState","selectAll","remove","position","num","id","visulizeBox","drawSeparator","drawIndicator","shouldComponentUpdate","nextProps","nextState","update1","update2","update3","update4","update5","componentDidUpdate","prevProps","prevState","action","desc","how","moveAction","split","to","move","selectAction","select","deselect","from","indicatorID","indicatorMoveAction","indicatorTo","elementStage1","elementID","elementMove1","shift","separatorAction","sepID","newSepPosition","elementStage2","elementMove2","elementStage3","elementMove3","sorted","elementFrom3","elementFrom2","elementFrom1","indicatorFrom","arrayMap","positions","indexes","indicatorRow","sepPosition","JSON","parse","stringify","push","number","index","sort","a","b","elementPosition","elementInitial","findMin","shiftPosition","sepCur","elementNewCol","sepNext","render","actionDisplay","cur","Math","min","run","newArray","generateRandomArray","newAction","animationStep","window","setInterval","clearInterval"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {GridStructure} from './GridStructure'\nimport {Button, ButtonGroup} from 'react-bootstrap';\n\n\nexport class SelectionSort extends GridStructure {\n    constructor(props) {\n        // 1: Grid Width 30px\n        // 2: Grid Height 30px\n        // 3: nRow: 3\n        // 4: nCol: 10\n        // 5: padding: 0.05\n        // 6: margin: top: 20px, bottom: 20px, left: 20px, right: 20px\n\n\n        super(props, 30, 30, 3, 10, 0.05, {\n            top: 20, bottom: 20, left: 20, right: 20\n        }, \"selection\")\n\n        this.svg = null;\n\n        this.indicatorInitial = {\n            row: 3,\n            col: 10\n        }\n\n        this.separatorInitial = {\n            row: 1,\n            col: 1\n        }\n\n        this.getInitialPosition = this.getInitialPosition.bind(this);\n        this.getAction = this.getAction.bind(this);\n        this.visulizeFind = this.visulizeFind.bind(this);\n        this.visulizeMove = this.visulizeMove.bind(this);\n        this.visulizeFindInverse = this.visulizeFindInverse.bind(this);\n        this.visulizeMoveInverse = this.visulizeMoveInverse.bind(this);\n        this.initViz = this.initViz.bind(this)\n        this.clearViz = this.clearViz.bind(this)\n\n        let initArray = [3, 2, 6, 2, 9, 8, 4]\n\n        let actions = this.getAction(initArray)\n\n        this.state = {\n            array: initArray,\n            actions: actions,\n            step: 0,\n            speed: 200,\n            setNewArray: false,\n            animation: false\n        }\n    }\n\n    getInitialPosition(array = this.state.array) {\n        let positionMap = {}\n        for (let i = 0; i < array.length; i++) {\n            positionMap[i] = {\n                row: 2,\n                col: i + 2\n            }\n        } \n        return(positionMap)\n    }\n\n    componentDidMount() {\n        this.svg = this.getSVG();\n        this.drawBasicStructure();\n        this.initViz();\n        this.setState({\n            actions: this.getAction()\n        })\n    }\n\n    clearViz() {\n        this.svg.selectAll(\"g\").remove();\n    }\n\n    initViz() {\n        let positionMap = this.getInitialPosition();\n\n        for (let i = 0; i < this.state.array.length; i++) {\n            let position = positionMap[i]\n            let num = this.state.array[i]\n            let id = \"selection-\" + i\n            this.visulizeBox(position.row, position.col, 1, 1, num, id)\n        }\n\n        this.drawSeparator(this.separatorInitial.row, this.separatorInitial.col, \"selection\");\n        this.drawIndicator(this.indicatorInitial.row, this.indicatorInitial.col, \"min\", \"selection\");\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        let update1 = this.state.step !== nextState.step;\n        let update2 = nextState.setNewArray;\n        let update3 = nextState.animation !== this.state.animation\n        let update4 = nextState.animation \n        let update5 = nextState.step >= 0 && nextState.step < nextState.actions.length;\n\n        return (update1 || update2 || update3 || update4) && update5\n    }\n\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.setNewArray) {\n            this.clearViz();\n            this.initViz();\n            this.setState({\n                setNewArray: false\n            })\n        } else {\n            if (this.state.step > prevState.step) {\n                let action = this.state.actions[this.state.step];\n                if (action.desc === \"Find the Lowest #\") {\n                    this.visulizeFind(action.how)\n                } else if (action.desc === \"Move the Lowest # to the End of Sorted Array\") {\n                    this.visulizeMove(action.how)\n                }\n            } else if (this.state.step < prevState.step) {\n                let action = this.state.actions[prevState.step];\n                if (action.desc === \"Find the Lowest #\") {\n                    this.visulizeFindInverse(action.how);\n                } else if (action.desc === \"Move the Lowest # to the End of Sorted Array\") {\n                    this.visulizeMoveInverse(action.how)\n                }\n            }   \n        }\n    }\n\n    visulizeFind(how) {\n        let moveAction = how[0].split(\" \")        \n\n        let id = moveAction[1]\n        let to = moveAction[3].split(\"-\")\n\n        this.move(id, to[0], to[1], 0.15, 0.05, () => {\n            let selectAction = how[1]\n            this.select(selectAction.split(\" \")[1], null, this.state.speed)\n        }, this.state.speed)\n    }\n\n    visulizeFindInverse(how) {\n        let selectAction = how[1]\n        this.deselect(selectAction.split(\" \")[1], () => {\n            let moveAction = how[0].split(\" \")\n            let from = moveAction[2].split(\"-\")\n            let indicatorID = moveAction[1];\n            this.move(indicatorID, from[0], from[1], 0.15, 0.05, null, this.state.speed)\n        },this.state.speed)\n    }\n\n    visulizeMove(how) {\n        let indicatorMoveAction = how[0].split(\" \");\n        let indicatorID = indicatorMoveAction[1];\n        let indicatorTo = indicatorMoveAction[3].split(\"-\")\n        this.move(indicatorID, indicatorTo[0], indicatorTo[1], 0.15, 0.05, () => {\n            let elementStage1 = how[1].split(\" \")\n            let elementID = elementStage1[1]\n            let elementMove1 = elementStage1[3].split(\"-\")\n            this.move(elementID, elementMove1[0], elementMove1[1], 0.05, 0.05, () => {\n                this.shift(how[2], () => {\n                    let separatorAction = how[3].split(\" \")\n                    let sepID = separatorAction[1]\n                    let newSepPosition = separatorAction[3].split(\"-\")\n                    this.move(sepID, newSepPosition[0], newSepPosition[1], 0.5, 1, () => {\n                        let elementStage2 = how[4].split(\" \")\n                        let elementMove2 = elementStage2[3].split(\"-\")\n                        this.move(elementID, elementMove2[0], elementMove2[1], 0.05, 0.05, () => {\n                            let elementStage3 = how[5].split(\" \")\n                            let elementMove3 = elementStage3[3].split(\"-\")\n                            this.move(elementID, elementMove3[0], elementMove3[1], 0.05, 0.05, () => {\n                                this.sorted(elementID, this.state.speed)\n                            }, this.state.speed)\n                        }, this.state.speed)\n                    }, this.state.speed)\n                }, this.state.speed, 1)\n            }, this.state.speed)\n        }, this.state.speed)\n    }\n\n\n\n    visulizeMoveInverse(how) {\n        let elementStage3 = how[5].split(\" \")\n        let elementID = elementStage3[1]\n        this.select(elementID, () => {\n            let elementFrom3 = elementStage3[2].split(\"-\")\n            this.move(elementID, elementFrom3[0], elementFrom3[1], 0.05, 0.05, () => {\n                let elementStage2 = how[4].split(\" \")\n                let elementFrom2 = elementStage2[2].split(\"-\")\n                this.move(elementID, elementFrom2[0], elementFrom2[1], 0.05, 0.05, () => {\n                    let separatorAction = how[3].split(\" \")\n                    let sepID = separatorAction[1]\n                    let newSepPosition = separatorAction[2].split(\"-\") \n                    this.move(sepID, newSepPosition[0], newSepPosition[1], 0.5, 1, () => {\n                        this.shift(how[2], () => {\n                            let elementStage1 = how[1].split(\" \")\n                            let elementFrom1 = elementStage1[2].split(\"-\")\n                            this.move(elementID, elementFrom1[0], elementFrom1[1], 0.05, 0.05, () => {\n                                let indicatorMoveAction = how[0].split(\" \");\n                                let indicatorID = indicatorMoveAction[1];\n                                let indicatorFrom = indicatorMoveAction[2].split(\"-\") \n                                this.move(indicatorID, indicatorFrom[0], indicatorFrom[1], 0.15, 0.05, null, this.state.speed)\n                            }, this.state.speed)\n                        }, this.state.speed, 0)\n                    }, this.state.speed)\n                }, this.state.speed)\n            }, this.state.speed)\n        }, this.state.speed)\n    }\n\n    getAction(array = this.state.array) {\n        let actions = [{\n            desc: \"Start Sorting\",\n            how: []\n        }];\n        let arrayMap = [];\n        let positions = this.getInitialPosition(array);\n        let indexes = [];\n        let indicatorRow = this.indicatorInitial.row;\n\n        let sepPosition = JSON.parse(JSON.stringify(this.separatorInitial));\n\n        for (let i = 0; i < array.length; i++) {\n            indexes.push(i);\n            arrayMap.push({\n                number: array[i],\n                index: i\n            })\n        }\n\n        arrayMap = arrayMap.sort((a, b) => {\n            return a.number - b.number;\n        })\n        \n        for (let i = 0; i < arrayMap.length; i++) {\n            let index = arrayMap[i].index;\n            let elementPosition = positions[index]\n\n            let indicatorFrom = indicatorRow + \"-\" + this.indicatorInitial.col;\n            let indicatorTo = indicatorRow + \"-\" + elementPosition.col;\n\n            let elementID = \"selection-\" + index\n            let elementInitial = elementPosition.row + \"-\" + elementPosition.col;\n\n            let findMin = {\n                desc: \"Find the Lowest #\",\n                how: [\"Move indicator-selection \" + indicatorFrom + \" \" + indicatorTo, \n                        \"Select \" + elementID]\n            }\n\n            indexes[index] = null;\n\n            let shift = [];\n\n            let shiftPosition = null\n\n            for (let i = 0; i < index; i++) {\n                if (indexes[i] !== null) {\n                    let index = indexes[i];\n                    if (shift.length === 0) {\n                        shiftPosition = positions[index].row + \"-\" + positions[index].col\n                    }\n                    positions[index].col++;\n                    shift.push(\"selection-\" + index);\n                }\n            }\n\n\n            let sepCur = sepPosition.row + \"-\" + sepPosition.col;\n            sepPosition.col++;\n\n            let elementStage1 = (elementPosition.row + 1) + \"-\" + elementPosition.col;\n            let elementNewCol = sepPosition.col;\n            let elementStage2 = (elementPosition.row + 1) + \"-\" + elementNewCol;\n            let elementStage3 = elementPosition.row + \"-\" + elementNewCol;\n\n            let sepNext = sepPosition.row + \"-\" + sepPosition.col;\n\n            let move = {\n                desc: \"Move the Lowest # to the End of Sorted Array\",\n                how:[\"Move indicator-selection \" + indicatorTo + \" \" + indicatorFrom,\n                     \"Move \" + elementID + \" \" + elementInitial + \" \" + elementStage1,\n                     \"Shift \" + shift + \" \" + shiftPosition,\n                     \"Move separator-selection \" + sepCur + \" \" + sepNext,\n                     \"Move \" + elementID + \" \" + elementStage1 + \" \" + elementStage2,\n                     \"Move \" + elementID + \" \" + elementStage2 + \" \" + elementStage3\n                ]\n            }\n            actions.push(findMin);\n            actions.push(move);\n        }\n\n        actions.push({\n            desc: \"Sort Finished\",\n            how: []\n        })\n\n        return(actions)\n    }\n\n    render() {\n        let actionDisplay = \"Finding Algorithm\"\n\n        if (this.state.actions.length > 0) {\n            let cur = Math.min(this.state.actions.length - 1, this.state.step)\n            actionDisplay = this.state.actions[cur].desc;\n        }\n\n        let run = \"Play\"\n        if (this.state.animation) {\n            run = \"Pause\"\n        }\n\n        return(\n            <div id=\"selection\" className=\"animationBox\">\n                <div>{actionDisplay}</div>\n                <ButtonGroup>\n                <Button variant=\"secondary\" onClick={() => {\n                    if (this.state.step > 0) {\n                        this.setState({\n                            step: this.state.step - 1\n                        })\n                    }\n                }} disabled={this.state.step === 0 || this.state.animation}>Prev</Button>\n\n                <Button variant=\"secondary\" onClick={() => {\n                    if (this.state.step < this.state.actions.length - 1) {\n                        this.setState({\n                            step: this.state.step + 1\n                        })\n                    }\n                }} disabled={this.state.step === this.state.actions.length - 1 || this.state.animation}>Next</Button>\n\n                <Button variant=\"secondary\" onClick={() => {\n                    let newArray = this.generateRandomArray(5, 8);\n                    let newAction = this.getAction(newArray);\n                    this.setState({\n                         array: newArray,\n                         actions: newAction,\n                         step: 0,\n                         setNewArray: true\n                    })\n                }} disabled={this.state.animation}>Generate New Array</Button>\n\n                <Button variant=\"secondary\" onClick={() => {\n                    if (!this.state.animation) {\n                        let animationStep = () => {\n                            this.setState({\n                                animation: window.setInterval(() => {\n                                    if (this.state.step < this.state.actions.length - 1) {\n                                        this.setState({\n                                            step: this.state.step + 1\n                                        })   \n                                    } else {\n                                        window.clearInterval(this.state.animation);\n                                        this.setState({\n                                            animation: false\n                                        })\n                                    }\n                                }, 1200)\n                            })\n                        }\n\n                        if (this.state.step === this.state.actions.length - 1) {\n                            this.setState({\n                                step: 0\n                            }, () => {\n                                this.clearViz();\n                                this.initViz();\n                                animationStep();\n                            })\n                        } else {\n                            animationStep();\n                        }\n                    } else {\n                        window.clearInterval(this.state.animation);\n                        this.setState({\n                            animation: false\n                        })\n                    }\n                }}>{run}</Button>\n                </ButtonGroup>\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}